博弈视角下的区块链安全、激励相容与ERC-20
===
汤舒扬

自从接触区块链以来的五年间，总是纳闷一些问题：区块链的安全性、激励相容性到底和历史算力、矿机数量、电费、矿机价格这四个变量成什么关系？寥寥6个变量之间的关系，却似乎谁也解释不清楚。

本文中，作者尝试从个人角度给出这一问题的一种解释，并提出一些潜在的隐患。

激励相容
$$IC:  \ \ E(短时收益) > E(短时代价)$$
不等式两边分别表示平均挖一个区块的“总体”收益和“总体”耗电（而无关矿机价格）。
有读者会问：不应该按照每个占据q比例总算力的个人来算吗？是否存在整体与个体间的矛盾？
其实这个矛盾是不存在的，对于每个个人，其期望收益和耗电恰好都需在上式左右乘上一个q，因而这个q可以直接消去。

安全性
$$SEC:\ \  E(破坏代价) > 链载总价值$$

这个定义看似有些匪夷所思，但其背后的逻辑是：一旦能通过特定策略攻垮一条链，那在这条链上就可以为所欲为了，虽然不能伪造签名把别人的币都提走、但原理上可以假设它能在所有人注意到不对劲前无限双花，花完总市值的一个比例。由于本文一切算式都只是粗略的估算，为了不增加不必要的多余变量，这个比例我们就假设成1，而不增加新的乘数了。

另一个问题是如何定义“破坏”，我们这里假想只有一种破坏：当敌手算力达到一个程度（比如本文中我们假设1/3），就可以通过特定策略对链进行51%攻击。实际上，在敌手能造成一定对于chain quality的攻击到能发动51%攻击之间，存在一个巨大的中间地带，在这个中间地带，敌手可以通过各类策略得到超过它算力比重应得的收益、并有机会发动一些偶然性的、短时的攻击。然而再次地，本文中一切算式只是“大道”层面的估算，所以对这个中间地带暂不考虑。

值得一提的是，本文中一切以汉字命名的变量在表示价值时以主链通证为本位，虽然通证历史价值会有波动，但在分析短时安全性与激励相容问题时，我们假设短期内不会有巨大波动。
<> ##所有以$C_{汉字}$命名的变量在表示价值时以法币为本位。##

理论一
-
历史算力是矿机数量关于时间的积分

$$ E(短时收益) = \hat{S_R} + \hat{S_F} $$

$$ E(短时代价) = W_{总}\cdot P_{电} = \frac{C_{总机价}}{C_{单机价}}\cdot W_{单机}\cdot P_{电} $$

$$ E(破坏代价) = 1/3 \cdot C_{总机价} $$

$$ 链载总价值 =  \sum_t S_R(t) + S_{ERC-20} $$

根据不等式SEC，

$$ C_{总机价} > 3\sum_t S_R(t) + 3S_{ERC-20} $$

根据不等式IC，

$$  \hat{S_R} + \hat{S_F} > \frac{W_{单机}\cdot P_{电}}{C_{单机价}}\cdot  C_{总机价} $$

综合上述两式，我们得到：

$$  \hat{S_R} + \hat{S_F} > \frac{3W_{单机}\cdot P_{电}}{C_{单机价}}\cdot \left(\sum_t S_R(t) + S_{ERC-20} \right).$$

对于一个新型通证，在其发展早期（话虽如此，至今还未有币种跨过了这一早期），我们可以认为 $\hat{S_R} \gg \hat{S_F}$, 以及$\sum_t S_R(t) = \hat{S_R}\cdot L$。于是就有：

$$  \hat{S_R} > \frac{3W_{单机}\cdot P_{电}}{C_{单机价}}\cdot \left(\hat{S_R}\cdot L + S_{ERC-20} \right).$$

对于除ETH之外的大多数链种，$S_{ERC-20}  \ll \hat{S_R}\cdot L$（对于无图灵完备智能合约功能的链种$S_{ERC-20}=0$），因而对于他们而言存在下式：

$$  C_{单机价}> 3W_{单机}\cdot P_{电} \cdot L = 常数 \times 单机全历史运行消耗电费.$$

结论一：矿机得要贵！
-
由于$C_{单机价} = 常数 \times  哈希电路造价$，综合上式，我们得到一个超乎直觉的结论：

哈希电路造价 除以 哈希电路功耗 要大！

通俗而言，就是矿机得要贵！
这个结论意味着什么呢？抛去生态发展因素，这归根到底是对一个哈希算法的要求。由于本人对于微电子行业不了解，假如电路消耗主要和电路宽度成正比（当然，现实的情况比这复杂得多），则我不妨翻译成：为了激励相容与区块链安全性，我们得要求区块链之PoW底层cryptographic hash function有这样的特征，倘若使之为以电路宽度为标号的函数族，则它的电路复杂度要尽可能大（为保持严谨，笔者不用复杂性三字）。

结论二：所有进入二级市场的ERC-20通证要显式登记在链、每次挖矿后mint一部分给矿工。
-
这是个很理想主义的结论、不好实施。但长远来看似乎是解决激励相容与安全问题的最好办法。
如何保证每家通过ERC-20发行通证的项目方遵循规则？我觉得解决办法是会有的，但不属于本文范畴。